<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Homepage</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="statistical_analysis.html">Exploratory Analysis</a>
</li>
<li>
  <a href="map_viz_kyung.html">Dashboard</a>
</li>
<li>
  <a href="https://ll3344.shinyapps.io/shiny/">Interactive Prediction Tool</a>
</li>
<li>
  <a href="final_report.html">Final Report</a>
</li>
<li>
  <a href="screencast.html">
    <span class="fa fa-video fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/chaojy/p8105_final_ped_covid">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Analysis</h1>

</div>


<div id="setup" class="section level2">
<h2>Setup</h2>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.4     v dplyr   1.0.2
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(patchwork)
library(corrplot)</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre class="r"><code>library(mgcv)</code></pre>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     collapse</code></pre>
<pre><code>## This is mgcv 1.8-33. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<pre class="r"><code>library(modelr)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = 1.1,
  out.width = &quot;100%&quot;)

theme_set(theme_minimal() + theme(legend.position = &quot;bottom&quot;))

options(
  ggplot2.continuous.colour = &quot;viridis&quot;,
  ggplot2.continuous.fill = &quot;viridis&quot;)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d

knitr::opts_chunk$set(comment = NA, message = FALSE, warning = FALSE, echo = TRUE)</code></pre>
</div>
<div id="data-import-and-tidy" class="section level2">
<h2>Data import and tidy</h2>
<pre class="r"><code>data_stats = read_csv(&quot;./data/datacomplete.csv&quot;) %&gt;% 
  mutate_at(c(&quot;admitted&quot;, &quot;ethnicity_race&quot;, &quot;asthma&quot;, &quot;diabetes&quot;, &quot;gender&quot;, &quot;obesity&quot;, &quot;icu&quot;), as.factor) %&gt;% 
  select(admitted, icu, age, ethnicity_race, gender, ses, obesity, bmi_value, systolic_bp_value, asthma, diabetes)

summary(data_stats)</code></pre>
<pre><code> admitted  icu          age                ethnicity_race gender 
 no :250   0:355   Min.   : 0.00   american indian:  5    F:191  
 yes:125   1: 20   1st Qu.:10.00   asian          :  9    M:184  
                   Median :18.00   black          : 88           
                   Mean   :14.63   caucasian      : 22           
                   3rd Qu.:21.00   latino         :233           
                   Max.   :22.00   multiple       : 18           
      ses          obesity   bmi_value     systolic_bp_value asthma  diabetes
 Min.   :-13.506   0:255   Min.   :12.03   Min.   : 61       0:314   0:358   
 1st Qu.: -6.883   1:120   1st Qu.:18.80   1st Qu.:105       1: 61   1: 17   
 Median : -3.890           Median :23.54   Median :116                       
 Mean   : -4.146           Mean   :25.66   Mean   :116                       
 3rd Qu.: -1.738           3rd Qu.:30.86   3rd Qu.:126                       
 Max.   :  2.931           Max.   :80.84   Max.   :182                       </code></pre>
</div>
<div id="dataset-exploration" class="section level2">
<h2>Dataset exploration</h2>
<p>This is a dataset of 375 pediatric patients 0 to 23 years of age with COVID-19 infection. First, we explore the data by generating various ggplots.</p>
<div id="age" class="section level3">
<h3>Age</h3>
<p>There appears to be a bimodal distribution of hospital admission as a function of age. Among infants and toddlers less than 5 years of age who test positive for COVID-19, more are admitted than not admitted. However, after 16 years of age, hospitalizations for COVID-19 infection appear to be less than non-hospitalizations.</p>
<p>Some pediatric patients require admission to the Intensive Care Unit (ICU). Fewer infants and toddlers with COVID-19 infection require admission to the ICU until about 3 years of age. Beginning at 10 years of age, there seems to be a steeper rise in the density of ICU admissions for children with COVID-19 infection compared to non-ICU admissions.</p>
<pre class="r"><code>admitt_p = 
  data_stats %&gt;% 
  ggplot(aes(x = age, fill = admitted)) +
  geom_density(alpha = .6) +
  labs(
    title = &quot;Admittance/Age Distribution&quot;,
    x = &quot;Age (Years)&quot;,
    y = &quot;Density&quot;) +
  theme(legend.position = &quot;bottom&quot;)

icu_p = 
  data_stats %&gt;% 
  ggplot(aes(x = age, fill = icu)) +
  geom_density(alpha = .6) +
  labs(
    title = &quot;ICU/Age Distribution&quot;,
    x = &quot;Age (Years)&quot;,
    y = &quot;Density&quot;) +
  theme(legend.position = &quot;bottom&quot;)

admitt_p / icu_p</code></pre>
<p><img src="statistical_analysis_files/figure-html/density%20admit-1.png" width="100%" /></p>
</div>
<div id="obesity-diabetes-and-asthma" class="section level3">
<h3>Obesity, diabetes, and asthma</h3>
<p>The distribution of obesity, diabetes, and asthma diagnoses in pediatric patients with COVID-19 infection by age are show below. Obesity, as defined as a body mass index (BMI) of &gt; 30, is general not present at ages less than 10 years. After 10 years, the prevalence of obesity increases. This is generally true for diabetes and asthma as well.</p>
<pre class="r"><code>obesity_p = 
  data_stats %&gt;% 
  ggplot(aes(x = age, fill = obesity)) +
  geom_density(alpha = .6) +
  labs(
    title = &quot;Obesity/Age Distribution&quot;,
    x = &quot;Age (Years)&quot;,
    y = &quot;Density&quot;) +
  theme(legend.position = &quot;bottom&quot;)

diabetes_p = 
  data_stats %&gt;% 
  ggplot(aes(x = age, fill = diabetes)) +
  geom_density(alpha = .6) +
  labs(
    title = &quot;Diabetes/Age Distribution&quot;,
    x = &quot;Age (Years)&quot;,
    y = &quot;Density&quot;) +
  theme(legend.position = &quot;bottom&quot;)

asthma_p = 
  data_stats %&gt;% 
  ggplot(aes(x = age, fill = asthma)) +
  geom_density(alpha = .6) +
  labs(
    title = &quot;Asthma/Age Distribution&quot;,
    x = &quot;Age (Years)&quot;,
    y = &quot;Density&quot;) +
  theme(legend.position = &quot;bottom&quot;)

obesity_p / diabetes_p / asthma_p</code></pre>
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-3-1.png" width="100%" /></p>
</div>
<div id="box-plots" class="section level3">
<h3>Box plots</h3>
<p>Below, we explore first systolic blood pressure, BMI, and socioeconomic status (SES) by admission status. The median first systolic pressure is higher among admitted patients compared to non-admitted patients. BMI appears to be similar, with some high BMI outliers in the non-hospitalized group. Median SES is lower among admitted patients.</p>
<pre class="r"><code>bp_p =
  data_stats %&gt;% 
  ggplot(aes(x = icu, y = systolic_bp_value)) +
  geom_boxplot() +
  labs(
    title = &quot;Systolic Blood Pressure by Admission Status&quot;,
    x = &quot;Hospital Admission Status&quot;,
    y = &quot;Systolic Blood Pressure&quot;)

bmi_p =
  data_stats %&gt;% 
  ggplot(aes(x = icu, y = bmi_value)) +
  geom_boxplot() +
  labs(
    title = &quot;BMI by Admission Status&quot;,
    x = &quot;Hospital Admission Status&quot;,
    y = &quot;BMI Value&quot;)

ses_p =
  data_stats %&gt;% 
  ggplot(aes(x = icu, y = ses)) +
  geom_boxplot() +
  labs(
    title = &quot;Socioeconomic Status by Admission Status&quot;,
    x = &quot;Hospital Admission Status&quot;,
    y = &quot;SES Measure&quot;)

bp_p / bmi_p / ses_p</code></pre>
<p><img src="statistical_analysis_files/figure-html/boxplots-1.png" width="100%" /></p>
</div>
</div>
<div id="possible-models" class="section level2">
<h2>Possible Models</h2>
<pre class="r"><code>##consider recoding to have caucasian race as reference - I believe this may generates more interpretible odds ratios.  I have included the code that I wrote at the end of the visualizations.rmd.

##Also, for ease of readability, consider OR as first column, then p values, then 95% CIs?

ped_covid =
  read_csv(&quot;./data/p8105_final_ped_covid.csv&quot;) %&gt;%
  mutate(
    ethnicity_race = case_when(
      race == &quot;R3 Black or African-American&quot;        ~ &quot;black&quot;,
      race == &quot;R2 Asian&quot;                            ~ &quot;asian&quot;,
      race == &quot;R5 White&quot;                            ~ &quot;caucasian&quot;,
      race == &quot;R1 American Indian or Alaska Native&quot; ~ &quot;american indian&quot;,
      race == &quot;Multiple Selected&quot;                   ~ &quot;multiple&quot;,
      ethnicity == &quot;E1 Spanish/Hispanic/Latino&quot;     ~ &quot;latino&quot;
    )
  ) %&gt;%
  mutate(
    asthma = replace_na(asthma_dx, 0),
    asthma = str_replace(asthma, &quot;.*J.*&quot;, &quot;1&quot;),
    diabetes = replace_na(diabetes_dx, 0),
    diabetes = str_replace(diabetes, &quot;.*E.*&quot;, &quot;1&quot;),
    zip = as.character(zip_code_set),
    service = outcomeadmission_admission_1inpatient_admit_service, 
    ed = ed_yes_no_0_365_before,
    admission_dx = admission_apr_drg,
    icu = icu_yes_no
  ) %&gt;%
  mutate(obesity = case_when(
    bmi_value &gt;= 30 ~ &quot;1&quot;,
    bmi_value &lt; 30 ~&quot;0&quot;
  ))

zipcode_df = 
  usa::zipcodes

ped_covid = 
  left_join(ped_covid, zipcode_df, by = &quot;zip&quot;) %&gt;%
  select(admitted, age, gender, ses, zip, eventdatetime, bmi_value, icu, icu_date_time, 
         systolic_bp_value, ethnicity_race, asthma, diabetes, zip, service, ed, admission_dx,
         city.y, obesity, lat, long) %&gt;%
  mutate_at(c(&quot;admitted&quot;, &quot;icu&quot;, &quot;ethnicity_race&quot;, &quot;asthma&quot;, &quot;diabetes&quot;,
              &quot;ed&quot;, &quot;city.y&quot;, &quot;obesity&quot;), as.factor) %&gt;%
  mutate(
    gender = factor(gender, levels = c(&quot;F&quot;, &quot;M&quot;)),
    ethnicity_race = factor(ethnicity_race, levels = c(&quot;caucasian&quot;, &quot;black&quot;, &quot;latino&quot;, &quot;asian&quot;))
  ) %&gt;%
  rename(city = city.y)

train_data =
  ped_covid %&gt;%
  slice(1:250)

test_data =
  ped_covid %&gt;%
  slice(251:375)</code></pre>
<div id="race-only-categoruical-model" class="section level3">
<h3>Race only categoruical Model</h3>
<pre class="r"><code>race_mod =
glm(
  admitted ~ age + gender + ethnicity_race + asthma + diabetes + obesity,
  data = ped_covid,
  family = binomial()
  ) %&gt;% 
  broom::tidy() %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;% 
  select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
  knitr::kable(digits = 3)

race_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">5.101</td>
<td align="right">1.134</td>
<td align="right">22.939</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.938</td>
<td align="right">0.897</td>
<td align="right">0.981</td>
<td align="right">0.005</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.728</td>
<td align="right">0.409</td>
<td align="right">1.295</td>
<td align="right">0.280</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceblack</td>
<td align="right">0.336</td>
<td align="right">0.086</td>
<td align="right">1.318</td>
<td align="right">0.118</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_racelatino</td>
<td align="right">0.344</td>
<td align="right">0.092</td>
<td align="right">1.286</td>
<td align="right">0.113</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceasian</td>
<td align="right">0.323</td>
<td align="right">0.044</td>
<td align="right">2.371</td>
<td align="right">0.266</td>
</tr>
<tr class="odd">
<td align="left">asthma1</td>
<td align="right">0.931</td>
<td align="right">0.468</td>
<td align="right">1.856</td>
<td align="right">0.840</td>
</tr>
<tr class="even">
<td align="left">diabetes1</td>
<td align="right">3.764</td>
<td align="right">1.100</td>
<td align="right">12.880</td>
<td align="right">0.035</td>
</tr>
<tr class="odd">
<td align="left">obesity1</td>
<td align="right">2.166</td>
<td align="right">1.070</td>
<td align="right">4.384</td>
<td align="right">0.032</td>
</tr>
</tbody>
</table>
</div>
<div id="no-race-categorical-only-model" class="section level3">
<h3>No Race Categorical only model</h3>
<pre class="r"><code>no_race_mod =
glm(
  admitted ~ age + gender + asthma + diabetes + obesity,
  data = ped_covid,
  family = binomial()
  ) %&gt;% 
  broom::tidy() %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;% 
  select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
  knitr::kable(digits = 3)

no_race_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.570</td>
<td align="right">0.857</td>
<td align="right">2.876</td>
<td align="right">0.144</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.945</td>
<td align="right">0.910</td>
<td align="right">0.980</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.865</td>
<td align="right">0.519</td>
<td align="right">1.444</td>
<td align="right">0.580</td>
</tr>
<tr class="even">
<td align="left">asthma1</td>
<td align="right">0.864</td>
<td align="right">0.456</td>
<td align="right">1.639</td>
<td align="right">0.655</td>
</tr>
<tr class="odd">
<td align="left">diabetes1</td>
<td align="right">5.119</td>
<td align="right">1.574</td>
<td align="right">16.651</td>
<td align="right">0.007</td>
</tr>
<tr class="even">
<td align="left">obesity1</td>
<td align="right">1.812</td>
<td align="right">0.964</td>
<td align="right">3.403</td>
<td align="right">0.065</td>
</tr>
</tbody>
</table>
</div>
<div id="complex-model-containing-relevant-variables-continuous-included" class="section level3">
<h3>Complex model containing relevant variables (continuous included)</h3>
<pre class="r"><code>complex_mod = 
  glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + bmi_value + ses, 
      data = ped_covid,
      family = binomial(link = &quot;logit&quot;)
      ) %&gt;%  
  broom::tidy() %&gt;% 
   mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;%  
 select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
   knitr::kable(digits = 3)

complex_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.140</td>
<td align="right">0.149</td>
<td align="right">8.723</td>
<td align="right">0.900</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.930</td>
<td align="right">0.862</td>
<td align="right">1.004</td>
<td align="right">0.063</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.534</td>
<td align="right">0.261</td>
<td align="right">1.095</td>
<td align="right">0.087</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceblack</td>
<td align="right">0.549</td>
<td align="right">0.110</td>
<td align="right">2.733</td>
<td align="right">0.464</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_racelatino</td>
<td align="right">0.441</td>
<td align="right">0.092</td>
<td align="right">2.113</td>
<td align="right">0.306</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceasian</td>
<td align="right">0.246</td>
<td align="right">0.017</td>
<td align="right">3.623</td>
<td align="right">0.307</td>
</tr>
<tr class="odd">
<td align="left">asthma1</td>
<td align="right">0.959</td>
<td align="right">0.439</td>
<td align="right">2.095</td>
<td align="right">0.916</td>
</tr>
<tr class="even">
<td align="left">diabetes1</td>
<td align="right">5.286</td>
<td align="right">1.257</td>
<td align="right">22.233</td>
<td align="right">0.023</td>
</tr>
<tr class="odd">
<td align="left">bmi_value</td>
<td align="right">1.054</td>
<td align="right">1.009</td>
<td align="right">1.100</td>
<td align="right">0.017</td>
</tr>
<tr class="even">
<td align="left">ses</td>
<td align="right">0.990</td>
<td align="right">0.873</td>
<td align="right">1.123</td>
<td align="right">0.876</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cor_data = 
  cor(model.matrix(admitted ~ age + gender + ethnicity_race + asthma + diabetes + bmi_value + ses, ped_covid)[,-1])

cor_data %&gt;% 
  corrplot(method = &quot;color&quot;, addCoef.col = &quot;black&quot;, tl.col = &quot;black&quot;, tl.srt = 45, insig = &quot;blank&quot; , number.cex = 0.7, diag = FALSE)</code></pre>
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-7-1.png" width="100%" /></p>
</div>
<div id="complex-model-but-without-ses-variable" class="section level3">
<h3>Complex model but without SES variable</h3>
<pre class="r"><code>complex_no_ses_mod = 
  glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + bmi_value, 
     data = ped_covid,
      family = binomial(link = &quot;logit&quot;)
      ) %&gt;%  
  broom::tidy() %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;%  
  select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
  knitr::kable(digits = 3)

complex_no_ses_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.273</td>
<td align="right">0.473</td>
<td align="right">10.912</td>
<td align="right">0.305</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.917</td>
<td align="right">0.873</td>
<td align="right">0.965</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.659</td>
<td align="right">0.368</td>
<td align="right">1.180</td>
<td align="right">0.160</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceblack</td>
<td align="right">0.332</td>
<td align="right">0.083</td>
<td align="right">1.322</td>
<td align="right">0.118</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_racelatino</td>
<td align="right">0.319</td>
<td align="right">0.084</td>
<td align="right">1.219</td>
<td align="right">0.095</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceasian</td>
<td align="right">0.343</td>
<td align="right">0.046</td>
<td align="right">2.545</td>
<td align="right">0.295</td>
</tr>
<tr class="odd">
<td align="left">asthma1</td>
<td align="right">0.798</td>
<td align="right">0.390</td>
<td align="right">1.635</td>
<td align="right">0.537</td>
</tr>
<tr class="even">
<td align="left">diabetes1</td>
<td align="right">3.006</td>
<td align="right">0.835</td>
<td align="right">10.820</td>
<td align="right">0.092</td>
</tr>
<tr class="odd">
<td align="left">bmi_value</td>
<td align="right">1.061</td>
<td align="right">1.019</td>
<td align="right">1.104</td>
<td align="right">0.004</td>
</tr>
</tbody>
</table>
</div>
<div id="complex-model-without-bmi-values" class="section level3">
<h3>Complex Model without BMI values</h3>
<pre class="r"><code>complex_no_bmi_mod = 
  glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + ses, 
     data = ped_covid,
      family = binomial(link = &quot;logit&quot;)
      ) %&gt;%  
  broom::tidy() %&gt;% 
  mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;%  
  select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
  knitr::kable(digits = 3)

complex_no_bmi_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.731</td>
<td align="right">0.129</td>
<td align="right">4.153</td>
<td align="right">0.724</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.976</td>
<td align="right">0.918</td>
<td align="right">1.037</td>
<td align="right">0.432</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.624</td>
<td align="right">0.322</td>
<td align="right">1.209</td>
<td align="right">0.162</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceblack</td>
<td align="right">0.868</td>
<td align="right">0.222</td>
<td align="right">3.393</td>
<td align="right">0.839</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_racelatino</td>
<td align="right">0.774</td>
<td align="right">0.205</td>
<td align="right">2.917</td>
<td align="right">0.705</td>
</tr>
<tr class="even">
<td align="left">ethnicity_raceasian</td>
<td align="right">0.449</td>
<td align="right">0.037</td>
<td align="right">5.479</td>
<td align="right">0.530</td>
</tr>
<tr class="odd">
<td align="left">asthma1</td>
<td align="right">1.828</td>
<td align="right">0.896</td>
<td align="right">3.729</td>
<td align="right">0.097</td>
</tr>
<tr class="even">
<td align="left">diabetes1</td>
<td align="right">8.525</td>
<td align="right">2.155</td>
<td align="right">33.722</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">ses</td>
<td align="right">0.988</td>
<td align="right">0.877</td>
<td align="right">1.113</td>
<td align="right">0.841</td>
</tr>
</tbody>
</table>
</div>
<div id="complex-model-with-interactions" class="section level3">
<h3>Complex Model with interactions</h3>
<pre class="r"><code>int_mod = 
  glm(admitted ~ age + gender + asthma + ethnicity_race + diabetes + bmi_value + ses + ses*bmi_value + diabetes*bmi_value, 
      data = ped_covid,
      family = binomial(link = &quot;logit&quot;)
      ) %&gt;%  
  broom::tidy() %&gt;% 
   mutate(
    OR = exp(estimate),
    CI_lower = exp(estimate - 1.96 * std.error),
    CI_upper = exp(estimate + 1.96 * std.error)
  ) %&gt;%  
 select(term, OR, starts_with(&quot;CI&quot;), p.value) %&gt;% 
   knitr::kable(digits = 3)

int_mod</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.122</td>
<td align="right">0.062</td>
<td align="right">20.302</td>
<td align="right">0.938</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.916</td>
<td align="right">0.846</td>
<td align="right">0.992</td>
<td align="right">0.031</td>
</tr>
<tr class="odd">
<td align="left">genderM</td>
<td align="right">0.537</td>
<td align="right">0.259</td>
<td align="right">1.116</td>
<td align="right">0.096</td>
</tr>
<tr class="even">
<td align="left">asthma1</td>
<td align="right">0.932</td>
<td align="right">0.419</td>
<td align="right">2.074</td>
<td align="right">0.863</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_raceblack</td>
<td align="right">0.555</td>
<td align="right">0.106</td>
<td align="right">2.898</td>
<td align="right">0.485</td>
</tr>
<tr class="even">
<td align="left">ethnicity_racelatino</td>
<td align="right">0.457</td>
<td align="right">0.092</td>
<td align="right">2.284</td>
<td align="right">0.340</td>
</tr>
<tr class="odd">
<td align="left">ethnicity_raceasian</td>
<td align="right">0.243</td>
<td align="right">0.015</td>
<td align="right">3.885</td>
<td align="right">0.317</td>
</tr>
<tr class="even">
<td align="left">diabetes1</td>
<td align="right">69.447</td>
<td align="right">2.550</td>
<td align="right">1891.485</td>
<td align="right">0.012</td>
</tr>
<tr class="odd">
<td align="left">bmi_value</td>
<td align="right">1.065</td>
<td align="right">0.975</td>
<td align="right">1.163</td>
<td align="right">0.162</td>
</tr>
<tr class="even">
<td align="left">ses</td>
<td align="right">1.044</td>
<td align="right">0.688</td>
<td align="right">1.584</td>
<td align="right">0.840</td>
</tr>
<tr class="odd">
<td align="left">bmi_value:ses</td>
<td align="right">0.998</td>
<td align="right">0.984</td>
<td align="right">1.013</td>
<td align="right">0.823</td>
</tr>
<tr class="even">
<td align="left">diabetes1:bmi_value</td>
<td align="right">0.927</td>
<td align="right">0.855</td>
<td align="right">1.005</td>
<td align="right">0.067</td>
</tr>
</tbody>
</table>
<pre class="r"><code># cv_df = 
#   crossv_mc(ped_covid, 100, test = 0.4) 
# cv_df %&gt;% pull(train) %&gt;% .[[1]] %&gt;% as_tibble
# cv_df %&gt;% pull(test) %&gt;% .[[1]] %&gt;% as_tibble
# 
# cv_df =
#   cv_df %&gt;% 
#   mutate(
#     train = map(train, as_tibble),
#     test = map(test, as_tibble))
# 
# cv_df =
#   cv_df %&gt;% 
#   mutate(
#     race_model             = map(train,  ~glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + obesity, data = .x)),
#     no_race_model          = map(train, ~glm(admitted ~ age + gender + asthma + diabetes + obesity, data = .x)),
#     complex_model          = map(train, ~glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + bmi_value + ses, data = .x)),
#     complex_no_ses_model   = map(train, ~glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + bmi_value, data = .x)),
#     complex_no_bmi_model   = map(train, ~glm(admitted ~ age + gender + ethnicity_race + asthma + diabetes + ses, data = .x)),
#     interaction_model      = map(train, ~glm(admitted ~ age + gender + asthma + ethnicity_race + diabetes + bmi_value + ses + ses*bmi_value + diabetes*bmi_value, data = .x))) %&gt;% 
#   mutate(
#     rmse_race              = map2_dbl(race_model, test, ~rmse(model = .x, data = .y)),
#     rmse_no_race           = map2_dbl(no_race_model, test, ~rmse(model = .x, data = .y)),
#     rmse_complex           = map2_dbl(complex_model, test, ~rmse(model = .x, data = .y)),
#     rmse_complex_no_ses    = map2_dbl(complex_no_ses_model, test, ~rmse(model = .x, data = .y)),
#     rmse_complex_no_bmi    = map2_dbl(complex_no_bmi_model, test, ~rmse(model = .x, data = .y)),
#     rmse_interaction       = map2_dbl(interaction_model, test, ~rmse(model = .x, data = .y)))</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
